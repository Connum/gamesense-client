/**
 * gamesense-client
 * @version 0.1.0-SNAPSHOT (2015-09-04)
 * @author Christian Schuller
 * @license MIT
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.gamesense=b()}(this,function(){var a={};return a.GameClient=function(a,b){"use strict";function c(){var b={game:a.name};d("/game_heartbeat",b)}function d(a,c){return new f(function(d){var f=JSON.stringify(c),g={host:b.host,port:b.port,path:a,method:"POST",headers:{"Content-Type":"application/json","Content-Length":f.length}},h=e.request(g,function(a){a.setEncoding("utf8"),a.on("data",function(b){console.log(a.statusCode+" < "+b),d(b)})});console.log("POST "+a,{json:f}),h.write(f),h.end()})}var e=require("http"),f=require("promise"),g=require("underscore"),h=10,i=null;this.registerGame=function(){var b={game:a.name,game_display_name:a.displayName,icon_color_id:a.iconColor};return d("/game_metadata",b)},this.registerEvent=function(b){var c={game:a.name,event:b.name,min_value:b.minValue,max_value:b.maxValue,icon_id:b.icon};return d("/register_game_event",c)},this.bindEvent=function(b,c){function e(a){var b={zone:a.zone,color:a.color,mode:a.mode};if(!a.deviceType)throw new Error("bindEvent failed: Missing device type.");return b["device-type"]=a.deviceType,a.rate&&(b.rate=a.rate),"GradientColor"===a.color.constructor.name&&(b.color={gradient:a.color}),a.customZoneKeys&&(b["custom-zone-keys"]=a.customZoneKeys),b}var f={game:a.name,event:b.name,min_value:b.minValue,max_value:b.maxValue,icon_id:b.icon,handlers:g.map(c,e)};return d("/bind_game_event",f)},this.sendGameEventUpdate=function(b){var c={game:a.name,event:b.name,data:{value:b.value}};return d("/game_event",c)},this.startHeartbeatSending=function(){i=setInterval(c,1e3*h)},this.stopHeartbeatSending=function(){i&&clearInterval(i)}},a.Color=function(a,b,c){"use strict";this.red=a,this.green=b,this.blue=c},a.DeviceType={KEYBOARD:"keyboard",MOUSE:"mouse",HEADSET:"headset",INDICATOR:"indicator",RGB_1_ZONE:"rgb-1-zone",RGB_2_ZONE:"rgb-2-zone",RGB_3_ZONE:"rgb-3-zone",RGB_5_ZONE:"rgb-5-zone",RGB_PER_KEY_ZONES:"rgb-per-key-zones"},a.EventIcon={NO_ICON:0,HEALTH:1,ARMOR:2,AMMUNITION:3,MONEY:4,FLASH_EXPLOSION:5,KILLS:6,HEADSHOT:7,HELMET:8,HUNGER:10,AIR_BREATH:11,COMPASS:12,TOOL_PICKAXE:13,MANA_POTION:14,CLOCK:15,LIGHTNING:16,ITEM_BACKPACK:17},a.Game=function(b,c,d){"use strict";this.name=b.toUpperCase(),this.displayName=c,this.iconColor=d||a.GameColor.SILVER},a.GameColor={ORANGE:0,GOLD:1,YELLOW:2,GREEN:3,TEAL:4,LIGHT_BLUE:5,BLUE:6,PURPLE:7,FUSCHIA:8,PINK:9,RED:10,SILVER:11},a.GameEvent=function(b){"use strict";this.name=b.toUpperCase(),this.icon=a.EventIcon.NO_ICON,this.minValue=0,this.maxValue=1,this.value=0},a.GameEventHandler=function(b,c,d){"use strict";this.deviceType=b||a.DeviceType.RGB_PER_KEY_ZONE,this.zone=c||"logo",this.customZoneKeys=null,this.color=d||new a.Color(0,0,255),this.mode=a.VisualizationMode.COLOR,this.rate=null},a.GradientColor=function(a,b){"use strict";this.zero=a,this.hundred=b},a.HeadsetZone={EARCUPS:"earcups"},a.RgbZone={ONE:"one"},a.KeyboardZone={FUNCTION_KEYS:"function-keys",MAIN_KEYBOARD:"main-keyboard",KEYPAD:"keypad",NUMBER_KEYS:"number-keys",MACRO_KEYS:"macro-keys"},a.MouseZone={WHEEL:"wheel",LOGO:"logo",BASE:"base"},a.RgbPerKeyZone={LOGO:"logo",A:"a",B:"b",C:"c",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",J:"j",K:"k",L:"l",M:"m",N:"n",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",U:"u",V:"v",W:"w",X:"x",Y:"y",Z:"z",KEYBOARD_1:"keyboard-1",KEYBOARD_2:"keyboard-2",KEYBOARD_3:"keyboard-3",KEYBOARD_4:"keyboard-4",KEYBOARD_5:"keyboard-5",KEYBOARD_6:"keyboard-6",KEYBOARD_7:"keyboard-7",KEYBOARD_8:"keyboard-8",KEYBOARD_9:"keyboard-9",KEYBOARD_0:"keyboard-0",RETURN:"return",ESCAPE:"escape",BACKSPACE:"backspace",TAB:"tab",SPACEBAR:"spacebar",CAPS:"caps",DASH:"dash",EQUAL:"equal",LEFT_BRACKET:"l-bracket",RIGHT_BRACKET:"r-bracket",BACKSLASH:"backslash",POUND_HASHMARK:"pound",SEMICOLON:"semicolon",QUOTE:"quote",BACKQUOTE:"backquote",COMMA:"comma",PERIOD:"period",SLASH:"slash",F1:"f1",F2:"f2",F3:"f3",F4:"f4",F5:"f5",F6:"f6",F7:"f7",F8:"f8",F9:"f9",F10:"f10",F11:"f11",F12:"f12",PRINT_SCREEN:"printscreen",SCROLL_LOCK:"scrolllock",PAUSE:"pause",INSERT:"insert",HOME:"home",PAGE_UP:"pageup",PAGE_DOWN:"pagedown",RIGHT_ARROW:"rightarrow",LEFT_ARROW:"leftarrow",DOWN_ARROW:"downarrow",UP_ARROW:"uparrow",KEYPAD_NUM_LOCK:"keypad-num-lock",KEYPAD_DIVIDE:"keypad-divide",KEYPAD_TIMES:"keypad-times",KEYPAD_MINUS:"keypad-minus",KEYPAD_PLUS:"keypad-plus",KEYPAD_ENTER:"keypad-enter",KEYPAD_PERIOD:"keypad-period",KEYPAD_0:"keypad-0",KEYPAD_1:"keypad-1",KEYPAD_2:"keypad-2",KEYPAD_3:"keypad-3",KEYPAD_4:"keypad-4",KEYPAD_5:"keypad-5",KEYPAD_6:"keypad-6",KEYPAD_7:"keypad-7",KEYPAD_8:"keypad-8",KEYPAD_9:"keypad-9",LEFT_CTRL:"l-ctrl",LEFT_SHIFT:"l-shift",LEFT_ALT:"l-alt",LEFT_WIN:"l-win",RIGHT_CTRL:"r-ctrl",RIGHT_SHIFT:"r-shift",RIGHT_ALT:"r-alt",RIGHT_WIN:"r-win",STEELSERIES_KEY:"ss-key",WIN_MENU:"win-menu",MACRO_0:"m0",MACRO_1:"m1",MACRO_2:"m2",MACRO_3:"m3",MACRO_4:"m4",MACRO_5:"m5",FUNCTION_KEYS:"function-keys",NUMBER_KEYS:"number-keys",Q_ROW:"q-row",A_ROW:"a-row",Z_ROW:"z-row",MACRO_KEYS:"macro-keys",ALL_MACRO_KEYS:"all-macro-keys",MAIN_KEYBOARD:"main-keyboard",NAV_CLUSTER:"nav-cluster",ARROWS:"arrows",KEYPAD:"keypad",KEYPAD_NUMBERS:"keypad-nums",ALL:"all"},a.RgbZone={ONE:"one",TWO:"two",THREE:"three",FOUR:"four",FIVE:"five"},a.ServerEndpoint=function(a){"use strict";function b(){a&&c(a)}function c(a){var b=/(http|ftp|https):\/\/([\w-]+(\.[\w-]*)+)([\w.,@?^=%&amp;:/~+#-]*[\w@?^=%&amp;/~+#-])?/,c=b.exec(a);d.url=a,d.baseUrl=a.replace(c[4],""),d.host=c[2],d.port=parseInt(c[4].replace(":",""))}var d=this,e=require("fs");this.url=a,this.baseUrl=null,this.host=null,this.port=null,this.discoverUrl=function(){var a="%PROGRAMDATA%/SteelSeries/SteelSeries Engine 3/coreProps.json",b=a.replace(/%([^%]+)%/g,function(a,b){return process.env[b]}),d=e.readFileSync(b,{encoding:"utf-8"});if(d){var f=JSON.parse(d);if(!f.address)throw new Error("Discover url failed: The core props does not contain address property.");c("http://"+f.address)}},b()},a.VisualizationMode={COLOR:"color",PERCENT:"percent",COUNT:"count"},a});